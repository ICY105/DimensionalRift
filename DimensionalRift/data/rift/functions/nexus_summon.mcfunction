execute align xyz run summon minecraft:villager ~0.5 ~ ~0.5 {CustomName:"[{\"text\":\"\"},{\"text\":\"████████\",\"color\":\"dark_green\",\"italic\":false}]",CustomNameVisible:1,UUIDLeast:1L,UUIDMost:1L,Tags:["nexus_core"],NoGravity:1b,Profession:5,Attributes:[{Name:generic.maxHealth,Base:400},{Name:generic.knockbackResistance,Base:1}],Health:400.0f,NoAI:1,Silent:1,Glowing:1b,Team:"nexus",Offers:{Recipes:[{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:1b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:iron_ingot",Count:32b}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:1b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond",Count:4b}},{rewardExp:1b,maxUses:1,uses:0,buy:{id:"minecraft:diamond",Count:4b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:ghast_tear",Count:1b,tag:{display:{Name:"{\"text\":\"Regen Buff Upgrade\",\"color\":\"light_purple\",\"italic\":false}",Lore:["§5Nexus passivly recovers health."]}}}},{rewardExp:1b,maxUses:1,uses:0,buy:{id:"minecraft:diamond",Count:8b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:obsidian",Count:1b,tag:{display:{Name:"{\"text\":\"Resistance Buff Upgrade\",\"color\":\"light_purple\",\"italic\":false}",Lore:["§5Nexus takes less damage."]}}}},{rewardExp:1b,maxUses:1,uses:0,buy:{id:"minecraft:diamond",Count:4b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:soul_sand",Count:1b,tag:{display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_aqua\",\"italic\":false}",Lore:["§5Nexus slows nearby mobs."]}}}},{rewardExp:1b,maxUses:1,uses:0,buy:{id:"minecraft:diamond",Count:8b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:wither_skeleton_skull",Count:1b,tag:{display:{Name:"{\"text\":\"Wither Aura Upgrade\",\"color\":\"dark_red\",\"italic\":false}",Lore:["§8Nexus withers nearby mobs."]}}}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:6b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond_sword",Count:1b,tag:{display:{Name:"{\"text\":\"Rift Blade\",\"color\":\"dark_purple\",\"italic\":false}"},AttributeModifiers:[{AttributeName:"generic.attackDamage",Name:"generic.attackDamage",Amount:10,Operation:0,UUIDLeast:10001,UUIDMost:10001,Slot:"mainhand"},{AttributeName:"generic.attackSpeed",Name:"generic.attackSpeed",Amount:-2,Operation:0,UUIDLeast:10000,UUIDMost:10000,Slot:"mainhand"}]}}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:5b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond_helmet",Count:1b,tag:{display:{Name:"{\"text\":\"Rift Helmet\",\"color\":\"dark_purple\",\"italic\":false}"},AttributeModifiers:[{AttributeName:"generic.maxHealth",Name:"generic.maxHealth",Amount:20,Operation:0,UUIDLeast:10004,UUIDMost:10004,Slot:"head"},{AttributeName:"generic.armor",Name:"generic.armor",Amount:3,Operation:0,UUIDLeast:10003,UUIDMost:10003,Slot:"head"},{AttributeName:"generic.armorToughness",Name:"generic.armorToughness",Amount:2,Operation:0,UUIDLeast:10002,UUIDMost:10002,Slot:"head"}]}}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:8b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond_chestplate",Count:1b,tag:{display:{Name:"{\"text\":\"Rift Chestplate\",\"color\":\"dark_purple\",\"italic\":false}"},AttributeModifiers:[{AttributeName:"generic.knockbackResistance",Name:"generic.knockbackResistance",Amount:1,Operation:0,UUIDLeast:10007,UUIDMost:10007,Slot:"chest"},{AttributeName:"generic.armor",Name:"generic.armor",Amount:8,Operation:0,UUIDLeast:10006,UUIDMost:10006,Slot:"chest"},{AttributeName:"generic.armorToughness",Name:"generic.armorToughness",Amount:2,Operation:0,UUIDLeast:10005,UUIDMost:10005,Slot:"chest"}]}}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:7b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond_leggings",Count:1b,tag:{display:{Name:"{\"text\":\"Rift Leggings\",\"color\":\"dark_purple\",\"italic\":false}"},AttributeModifiers:[{AttributeName:"generic.armor",Name:"generic.armor",Amount:6,Operation:0,UUIDLeast:10009,UUIDMost:10009,Slot:"legs"},{AttributeName:"generic.attackSpeed",Name:"generic.attackSpeed",Amount:.2,Operation:1,UUIDLeast:10010,UUIDMost:10010,Slot:"legs"},{AttributeName:"generic.armorToughness",Name:"generic.armorToughness",Amount:2,Operation:0,UUIDLeast:10008,UUIDMost:10008,Slot:"legs"}]}}},{rewardExp:1b,maxUses:2147483647,uses:0,buy:{id:"minecraft:diamond",Count:4b,tag:{ench:[{lvl:1,id:71}],display:{Name:"{\"text\":\"Unstable Matter\",\"color\":\"dark_purple\",\"italic\":false}",Lore:["§3Generated from rifts."]}}},sell:{id:"minecraft:diamond_boots",Count:1b,tag:{display:{Name:"{\"text\":\"Rift Boots\",\"color\":\"dark_purple\",\"italic\":false}"},AttributeModifiers:[{AttributeName:"generic.movementSpeed",Name:"generic.movementSpeed",Amount:.5,Operation:1,UUIDLeast:10013,UUIDMost:10013,Slot:"feet"},{AttributeName:"generic.armor",Name:"generic.armor",Amount:3,Operation:0,UUIDLeast:10012,UUIDMost:10012,Slot:"feet"},{AttributeName:"generic.attackSpeed",Name:"generic.attackSpeed",Amount:.,Operation:1,UUIDLeast:10010,UUIDMost:10010,Slot:"legs"},{AttributeName:"generic.armorToughness",Name:"generic.armorToughness",Amount:2,Operation:0,UUIDLeast:10011,UUIDMost:10011,Slot:"feet"}]}}}]}}

execute store result score rift_height rift_data run data get entity 00000000-0000-0001-0000-000000000001 Pos[1]
scoreboard players set 00000000-0000-0001-0000-000000000001 nexus_time -30
scoreboard players set 00000000-0000-0001-0000-000000000001 rift_power 0
playsound minecraft:item.totem.use voice @a[distance=..32] ~ ~ ~ 1 1 1
particle portal ~ ~1 ~ 0.25 0.25 0.25 1 1000
tellraw @a[distance=..96] ["",{"text":"A ","color":"dark_red"},{"text":"rift","color":"light_purple"},{"text":" to the underworld has been opened.","color":"dark_red"}]
advancement grant @a[distance=..96] only rift:rift
kill @s
